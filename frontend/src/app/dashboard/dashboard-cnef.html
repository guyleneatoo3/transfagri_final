<app-sidebar-layout>
  <!-- When no child route is selected, show overview cards -->
  <section class="grid gap-4 grid-cols-1 sm:grid-cols-2 xl:grid-cols-4" *ngIf="!isChildView">
    <button class="rounded-xl p-4 text-left shadow bg-sky-600 text-white hover:brightness-95" routerLink="/dashboard/cnef/emf">
      <div class="font-semibold">EMF actifs</div>
      <div class="text-3xl font-extrabold">{{ loading ? '...' : counts.emfs }}</div>
      <div class="underline text-sm">Voir détails →</div>
    </button>
    <button class="rounded-xl p-4 text-left shadow bg-amber-400 text-slate-900 hover:brightness-95" routerLink="/dashboard/cnef/indicateurs">
      <div class="font-semibold">Indicateurs</div>
      <div class="text-3xl font-extrabold">{{ loading ? '...' : counts.indicateurs }}</div>
      <div class="underline text-sm">Voir détails →</div>
    </button>
    <button class="rounded-xl p-4 text-left shadow bg-emerald-500 text-white hover:brightness-95" routerLink="/dashboard/cnef/questionnaires">
      <div class="font-semibold">Questionnaires</div>
      <div class="text-3xl font-extrabold">{{ loading ? '...' : counts.questionnaires }}</div>
      <div class="underline text-sm">Voir détails →</div>
    </button>
    <button class="rounded-xl p-4 text-left shadow bg-rose-500 text-white hover:brightness-95" routerLink="/dashboard/cnef/activites">
      <div class="font-semibold">Activités</div>
      <div class="text-3xl font-extrabold">{{ loading ? '...' : counts.activites }}</div>
      <div class="underline text-sm">Voir détails →</div>
    </button>
  </section>

  

  <!-- Combined charts using counts -->
  <section *ngIf="!isChildView">
    <app-kpi-charts
      [emfs]="counts.emfs"
      [indicateurs]="counts.indicateurs"
      [questionnaires]="counts.questionnaires"
      [activites]="counts.activites"
    ></app-kpi-charts>
    <app-extra-charts
      [emfs]="counts.emfs"
      [indicateurs]="counts.indicateurs"
      [questionnaires]="counts.questionnaires"
      [activites]="counts.activites"
    ></app-extra-charts>
  </section>

  <!-- Child content centered; visible when a child route is active -->
  <section *ngIf="isChildView">
    <div class="max-w-6xl mx-auto">
      <router-outlet></router-outlet>
    </div>
  </section>
</app-sidebar-layout>

